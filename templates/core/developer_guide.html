{% extends 'base.html' %}

{% block content %}
<div class="max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:px-8">
    
    <div class="text-center mb-12">
        <h1 class="text-3xl font-extrabold text-gray-900 sm:text-4xl">
            Developer Documentation
        </h1>
        <p class="mt-4 text-xl text-gray-500">
            Integrate our real-time job data into your applications.
        </p>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        
        <div class="lg:col-span-1 space-y-8">
            
            <div class="bg-white shadow rounded-lg p-6">
                <h3 class="text-lg font-bold text-gray-900 mb-2">üîê Authentication</h3>
                <p class="text-gray-600 text-sm mb-4">
                    We use API Keys for authentication. Pass your key in the header.
                </p>
                {% if has_key %}
                    <div class="bg-green-50 border border-green-200 rounded p-3 text-xs text-green-800">
                        ‚úÖ We have pre-filled the examples with your actual API Key prefix.
                    </div>
                {% else %}
                    <div class="bg-yellow-50 border border-yellow-200 rounded p-3 text-xs text-yellow-800">
                        ‚ö†Ô∏è You are on the Free Tier. Examples below use a placeholder key.
                        <a href="{% url 'dashboard' %}" class="underline font-bold">Upgrade to get a key.</a>
                    </div>
                {% endif %}
            </div>

            <div class="bg-white shadow rounded-lg p-6">
                <h3 class="text-lg font-bold text-gray-900 mb-2">üåç Filtering Jobs</h3>
                <p class="text-gray-600 text-sm mb-4">
                    You can filter jobs by passing query parameters.
                </p>
                <ul class="text-sm space-y-2 text-gray-700">
                    <li><code class="bg-gray-100 px-1 rounded">search</code> - Keyword (e.g., Python)</li>
                    <li><code class="bg-gray-100 px-1 rounded">location</code> - City or Country</li>
                </ul>
                
                <div class="mt-4">
                    <p class="text-xs font-bold text-gray-500 uppercase tracking-wide">Example: Jobs in Bulgaria</p>
                    <code class="block bg-gray-900 text-green-400 p-2 rounded mt-1 text-xs overflow-x-auto">
                        GET /api/jobs/?location=Bulgaria
                    </code>
                </div>
            </div>

        </div>

        <div class="lg:col-span-2">
            <div class="bg-white shadow rounded-lg overflow-hidden">
                
                <div class="border-b border-gray-200 bg-gray-50">
                    <nav class="flex -mb-px" aria-label="Tabs">
                        <button onclick="switchTab('curl')" id="tab-curl" class="w-1/3 py-4 px-1 text-center border-b-2 font-medium text-sm border-indigo-500 text-indigo-600">
                            cURL
                        </button>
                        <button onclick="switchTab('python')" id="tab-python" class="w-1/3 py-4 px-1 text-center border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300">
                            Python
                        </button>
                        <button onclick="switchTab('js')" id="tab-js" class="w-1/3 py-4 px-1 text-center border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300">
                            JavaScript
                        </button>
                    </nav>
                </div>

                <div class="p-6 bg-gray-900 min-h-[400px]">
                    
                    <div id="code-curl" class="code-block text-sm font-mono text-gray-300 space-y-4">
                        <p class="text-gray-500"># 1. Get all jobs</p>
                        <pre class="bg-black bg-opacity-30 p-4 rounded text-blue-400 overflow-x-auto">curl -X GET "{{ api_url }}" \
  -H "Authorization: Api-Key {{ key_prefix }}..."</pre>
                        
                        <p class="text-gray-500 mt-6"># 2. Get jobs in Bulgaria üáßüá¨</p>
                        <pre class="bg-black bg-opacity-30 p-4 rounded text-blue-400 overflow-x-auto">curl -X GET "{{ api_url }}?location=Bulgaria" \
  -H "Authorization: Api-Key {{ key_prefix }}..."</pre>
                    </div>

                    <div id="code-python" class="code-block hidden text-sm font-mono text-gray-300">
<pre class="text-green-400">import requests

url = "{{ api_url }}"
headers = {
    "Authorization": "Api-Key {{ key_prefix }}..."
}

# Example: Filtering for Bulgaria
params = {
    "location": "Bulgaria",
    "search": "Python"
}

response = requests.get(url, headers=headers, params=params)

if response.status_code == 200:
    jobs = response.json()
    print(f"Found {len(jobs)} jobs in Bulgaria!")
    for job in jobs:
        print(f"- {job['title']} at {job['company']}")
else:
    print("Error:", response.status_code)</pre>
                    </div>

                    <div id="code-js" class="code-block hidden text-sm font-mono text-gray-300">
<pre class="text-yellow-400">const url = "{{ api_url }}";
const apiKey = "{{ key_prefix }}...";

// Build the URL with parameters
const params = new URLSearchParams({
    location: "Bulgaria",
    search: "React"
});

fetch(`${url}?${params}`, {
    headers: {
        "Authorization": `Api-Key ${apiKey}`
    }
})
.then(response => response.json())
.then(data => {
    console.log(`Found ${data.length} jobs!`);
    data.forEach(job => {
        console.log(`Found: ${job.title}`);
    });
})
.catch(error => console.error('Error:', error));</pre>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>

<script>
    function switchTab(lang) {
        // Hide all
        document.querySelectorAll('.code-block').forEach(el => el.classList.add('hidden'));
        // Show active
        document.getElementById('code-' + lang).classList.remove('hidden');
        
        // Update tabs
        document.querySelectorAll('nav button').forEach(el => {
            el.classList.remove('border-indigo-500', 'text-indigo-600');
            el.classList.add('border-transparent', 'text-gray-500');
        });
        const activeBtn = document.getElementById('tab-' + lang);
        activeBtn.classList.remove('border-transparent', 'text-gray-500');
        activeBtn.classList.add('border-indigo-500', 'text-indigo-600');
    }
</script>
{% endblock %}